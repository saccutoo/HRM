@using HRM.App_LocalResources;
@using HRM.Common
<style>
    .policy-list-kpi .chosen-choices{
        max-height: 85px;
        overflow:auto;
    }
</style>
<div class="container-fluid">
    <div class="row" id="SavePolicy" style="margin: 0;">
        <form role="form" name="EditForm" ng-submit="SaveAction(tableInfo.AddUrl,EditForm)">
            <div class="col-md-12">
                <!-- START panel-->
                <div class="panel">
                    <div class="panel-heading"><h3 style="text-transform: none;">@AppRes.Policy</h3></div>
                    <hr />
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="row">
                                    <div class="col-md-3" style="line-height:30px;">
                                        <label>@AppRes.Policy <span style="color:red">(*)</span></label>
                                    </div>
                                    <div class="col-md-9">
                                        <input type="text" ng-model="Data.Name" class="form-control" ng-change="ChangeName()" />
                                        <span style="color:red;line-height:30px;">{{ErrorName}}</span>
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row">
                                    <div class="col-md-3" style="line-height:30px;">
                                        <label>@AppRes.Promotion_Status <span style="color:red">(*)</span></label>
                                    </div>
                                    <div class="col-md-9">
                                        @if (Global.CurrentLanguage == 5)
                                        {
                                            <select class="form-control" chosen options="getListStatus" on-no-result="doStuff" required data-modal="modal" ng-model="Data.Status" ng-options="list.Value as list.Name for list in getListStatus" ng-change="ChangeStatus()">
                                                <option value="" selected>--@AppRes.Select--</option>
                                            </select>
                                        }
                                        else
                                        {
                                            <select class="form-control" chosen options="getListStatus" on-no-result="doStuff" required data-modal="modal" ng-model="Data.Status" ng-options="list.Value as list.NameEN for list in getListStatus" ng-change="ChangeStatus()">
                                                <option value="" selected>--@AppRes.Select--</option>
                                            </select>
                                        }
                                        <span style="color:red;line-height:30px;">{{ErrorStatus}}</span>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <br />
                        <br />
                        <div class="row">
                            <div class="col-md-6">
                                <div class="row">
                                    <div class="col-md-3" style="line-height:30px;">
                                        <label>@AppRes.R_StartDate<span style="color:red"> (*)</span></label>
                                    </div>
                                    <div class="col-md-9">
                                        <input type="text" ng-model="Data.StartDate" class="StartDate form-control" ng-change="ChangeStartDate()" />
                                        <span style="color:red;line-height:30px;">{{ErrorStartDate}}</span>
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row">
                                    <div class="col-md-3" style="line-height:30px;">
                                        <label>@AppRes.EndDate </label>
                                    </div>
                                    <div class="col-md-9">
                                        <input type="text" ng-model="Data.EndDate" class="EndDate form-control" ng-change="ChangeEndDate()" />
                                        <span style="color:red;line-height:30px;">{{ErrorEndDate}}</span>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <br />
                        <br />
                        <div class="row">
                            <div class="col-md-6">
                                <div class="row">
                                    <div class="col-md-3" style="line-height:30px;">
                                        <label>@AppRes.Promotion_CreatedOn <span style="color:red">(*)</span></label>
                                    </div>
                                    <div class="col-md-9">
                                        <input type="text" ng-model="Data.Date" class="Date form-control" ng-change="ChangeDate()" />
                                        <span style="color:red;line-height:30px;">{{ErrorDate}}</span>
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row">
                                    <div class="col-md-3" style="line-height:30px;">
                                        <label>@AppRes.CustNote</label>
                                    </div>
                                    <div class="col-md-9">
                                        <textarea class="form-control" ng-model="Data.Note"></textarea>
                                        <span style="color:red;line-height:30px;">{{ErrorNote}}</span>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-md-6">
                                <div class="row">
                                    <div class="col-md-3" style="line-height:30px;">
                                        <label>@AppRes.Policyinclude</label>
                                    </div>
                                    <div class="col-md-9">
                                        <select class="form-control" chosen options="ListPolicy" on-no-result="doStuff" required data-modal="modal" ng-model="Data.PolicyincludeID" ng-options="list.PolicyID as list.Name for list in ListPolicy" ng-change="ChangePolicyincludeID()">
                                            <option value="" selected>--@AppRes.Select--</option>
                                        </select>
                                        <span style="color:red;line-height:30px;">{{ErrorPolicyincludeID}}</span>
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row">
                                    <div class="col-md-3" style="line-height:30px;">
                                        <label>@AppRes.KPI</label>
                                    </div>
                                    <div class="col-md-9 policy-list-kpi">
                                        @if (Global.CurrentLanguage == 5)
                                        {
                                            <select class="form-control" chosen multiple options="getListKPI" on-no-result="doStuff" required data-modal="modal" ng-model="Data.ListKPI" ng-options="list.GlobalListID as list.ValueEN for list in getListKPI"></select>
                                        }
                                        else
                                        {
                                            <select class="form-control" chosen multiple options="getListKPI" on-no-result="doStuff" required data-modal="modal" ng-model="Data.ListKPI" ng-options="list.GlobalListID as list.ValueEN for list in getListKPI"></select>
                                        }
                                    </div>

                                </div>
                            </div>
                            
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-md-6">
                                <div class="row">
                                    <div class="col-md-3" style="line-height:30px;">
                                        <label>@AppRes.Rewards <span style="color:red">(*)</span></label>
                                    </div>
                                    <div class="col-md-9">
                                        @if (Global.CurrentLanguage == 5)
                                        {
                                            <select class="form-control" chosen options="getListBonusPolicy" on-no-result="doStuff"  data-modal="modal" ng-model="Data.PolicyBonusID" ng-options="list.GlobalListID as list.Name for list in getListBonusPolicy" ng-change="ChangeRewards()">
                                                <option value="" selected>--@AppRes.Select--</option>
                                            </select>
                                        }
                                        else
                                        {
                                            <select class="form-control" chosen options="getListBonusPolicy" on-no-result="doStuff"  data-modal="modal" ng-model="Data.PolicyBonusID" ng-options="list.GlobalListID as list.NameEN for list in getListBonusPolicy" ng-change="ChangeRewards()">
                                                <option value="" selected>--@AppRes.Select--</option>
                                            </select>
                                        }         
                                        <span style="color:red;line-height:30px;">{{ErrorRewards}}</span>                 
                                    </div>

                                </div>
                            </div>
                            

                        </div>
                        @*<br />
                            <div class="col-sm-12">
                                <span style="color:red" ng-bind="Mesenger"></span>
                            </div>*@
                    </div>
                </div>
                <!-- END panel-->
            </div>
            @*<div class="col-md-12">
                @Html.Action("Index", "PolicyAllowance")
            </div>*@
            <div class="col-md-12">
                <style>
                    table tr td {
                    }

                    table th {
                        text-align: center;
                    }

                    .show-total {
                        color: blue;
                    }

                    .table-responsive {
                        overflow-x: unset !important;
                        height: auto !important;
                    }
                </style>
                <div class="col-lg-12">
                    <div class="col-md-12">
                        <div class="table-responsive">
                            <div class="row" style="margin: 0 0 15px;">
                                <table class="table table-striped table-bordered table-hover tabel-condensed">
                                    <thead>
                                        <tr class="success">
                                            <th>
                                            </th>
                                            <th ng-repeat="Column in ListColumnSpendingAdjustmentRate | orderBy:'OrderNo'">
                                                @if (Global.CurrentLanguage == 5)
                                                {
                                                    <span ng-bind='Column.DisplayName' ng-click="sort(Column.ColumnName)" style="cursor: pointer;"></span><br />
                                                }
                                                else
                                                {
                                                    <span ng-bind='Column.DisplayNameEn' ng-click="sort(Column.ColumnName)" style="cursor: pointer;"></span><br />
                                                }

                                                @*<span class="show-total" ng-bind="SetTotalByColumns(Column.ShowTotal)">-</span>*@
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr data-ng-repeat="item in Data.ListSpendingAdjustmentRate ">
                                            <td>
                                                <button class="mb-sm btn remove" ng-disabled=is_readonly type="button" ng-click="removeAdjustmentRate($index)">
                                                    <i class="fa fa-remove"></i>
                                                </button>
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <input type="text" placeholder="@AppRes.Month" class="form-control is-month" name="month_{{$index}}" data-modal="modal" ng-model="item.Month" required convert-to-month />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <input type="text" placeholder="@AppRes.Year" class="form-control input-date" name="year_{{$index}}" data-modal="modal" ng-model="item.Year" convert-to-month-year required />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <input type="text" ng-model="item.ReduceRate" class="form-control text-right" name="ReduceRate_{{$index}}" required />
                                                </div>
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <input type="text" ng-model="item.QuotaRate" class="form-control text-right" name="QuotaRate_{{$index}}" required />
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>

                                </table>
                                <br />
                                <button type="button" class="mb-sm btn addfields" ng-click="addAdjustmentRate()">
                                    <i class="fa fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br />
            <center>
                <button type="button" class="btn btn-success btn-labeled" ng-click="Save()">
                    <span class="btn-label">
                        <i class="fa fa-save"></i>
                    </span>@AppRes.btnUpdate
                </button>
                <button type="reset" class="btn btn-labeled" ng-click="CloseForm()">
                    <span class="btn-label">
                        <i class="fa fa-close"></i>
                    </span>@AppRes.btnCancel
                </button>
            </center>
        </form>
    </div>
</div>

